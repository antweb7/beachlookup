---
import { getCollection } from 'astro:content';
import { slugify } from '../lib/slug';
import Base from '../layouts/Base.astro';

const beaches = await getCollection('beaches');
---
<Base title="BeachLookup" description="Look up beaches by location and amenities.">
  <header class="mb-6">
    <h1 class="text-3xl font-semibold tracking-tight">BeachLookup</h1>
    <p class="mt-1 text-sm text-slate-600">Find the right beach, fast.</p>
  </header>

  <section class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
    {beaches.map((entry) => {
      const d = entry.data as any;
      const province = slugify(d.province ?? d.region);
      const locality = slugify(d.locality);
      const href = `/en/${province}/${locality}/beaches/${entry.slug}/`;
      return (
        <a href={href} class="group rounded-2xl border border-slate-200 bg-white p-4 shadow-sm transition hover:shadow-md">
          <div class="flex items-start justify-between gap-3">
            <div>
              <h2 class="text-base font-semibold text-slate-900 group-hover:text-slate-950">{d.title}</h2>
              <div class="mt-0.5 text-xs text-slate-600">{d.locality}, {d.province ?? d.region}</div>
            </div>
          </div>
          {Array.isArray(d.amenities) && d.amenities.length ? (
            <div class="mt-3 flex flex-wrap gap-2">
              {d.amenities.slice(0,3).map((a: string) => (
                <span class="inline-block rounded-full border border-slate-200 bg-slate-100 px-2.5 py-1 text-xs font-medium text-slate-700">{a}</span>
              ))}
            </div>
          ) : null}
        </a>
      );
    })}
  </section>
</Base>
